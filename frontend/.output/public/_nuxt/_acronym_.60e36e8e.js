import{a as P,b as J,i as oe,r as A,o as n,e as s,f as p,c as R,w as y,h as u,t as d,j as e,k as r,l as x,F as m,d as W,_ as K,m as g,p as ae,q as ie,u as t,s as M,v as V}from"./entry.c1549a97.js";import{a as C,M as de}from"./menu.0f9d3c11.js";import{_ as z}from"./date.b0c2944e.js";const re={key:0},ce={key:1},ue=e("hr",null,null,-1),_e={class:"flex justify-content-between flex-wrap"},me={key:0},pe={key:0},he=["onClick"],ge=["onClick"],ye=["onClick"],G={__name:"comments",props:{comments:{type:[Object,Array],required:!0}},emits:["signal"],setup(q,{emit:E}){const $=P(),l=J();oe("dialogRef");const I=W(()=>K(()=>import("./create_comment.ae3418d5.js"),["./create_comment.ae3418d5.js","./entry.c1549a97.js","./entry.076fc270.css","./menu.0f9d3c11.js","./menu.16430c06.css","./create_comment.6453e953.css"],import.meta.url)),D=(c,f=!1)=>{console.log(c),$.open(I,{props:{header:f?"Edit Comment":"Add Comment"},data:{belongs_to:c.belongs_to,comment_id:c.id,edit:f,text:f?c.text:""},onClose:()=>{w(c.belongs_to)}})},U=c=>{C.delete("/api/comments/"+c.id).then(()=>{l.add({severity:"success",summary:"Success",detail:"Comment deleted",life:3e3}),w(c.belongs_to)}).catch(f=>{l.add({severity:"error",summary:"Error",detail:f,life:3e3})})},w=c=>{E("signal",c)};return(c,f)=>{const T=G,S=A("AccordionTab"),L=A("Accordion");return n(!0),s(m,null,p(q.comments,_=>(n(),R(L,{activeIndex:0,style:{"margin-top":"0.5rem","margin-bottom":"0.5rem"}},{default:y(()=>[u(S,{header:_.deleted?"<deleted>":_.author},{default:y(()=>[_.deleted?(n(),s("span",re,"<deleted>")):(n(),s("span",ce,d(_.text),1)),ue,e("small",_e,[e("div",null,[u(z,{datetime:_.date},null,8,["datetime"]),r(),_.edited?(n(),s("span",me," | edited ")):x("",!0)]),_.deleted?x("",!0):(n(),s("div",pe,[e("span",{class:"link",onClick:j=>D(_)},"Reply",8,he),r(" | "),e("span",{class:"link",onClick:j=>D(_,!0)},"Edit",8,ge),r(" | "),e("span",{class:"link",onClick:j=>U(_)},"Delete",8,ye)]))]),u(T,{onSignal:w,comments:_.children},null,8,["comments"])]),_:2},1032,["header"])]),_:2},1024))),256)}}};const fe={class:"flex flex-column gap-3"},be={key:0},ke=e("br",null,null,-1),ve={class:"flex gap-2"},Ce={class:"flex flex-column gap-2"},xe={key:0},$e=e("b",null,"Origin Datasets",-1),De=["onClick"],we={key:1},Re=e("b",null,"Related Datasets",-1),Ae=["onClick"],Ee={key:2},Ie=e("b",null,"Datasets With the Same Origin",-1),Ue=["onClick"],Te={style:{"list-style":"none"},class:"flex flex-column gap-2"},Oe={class:"flex gap-2"},Se=e("b",null,"Acronym Aliases: ",-1),je=e("b",null,"Dataset Title: ",-1),Be=e("b",null,"Paper Title: ",-1),Le={class:"flex gap-2"},Ne=e("b",null,"Authors: ",-1),Ve=e("b",null,"Date Submitted: ",-1),qe=e("b",null,"Submitter: ",-1),Fe=e("b",null,"Name: ",-1),Me=e("b",null,"Email: ",-1),Pe=e("b",null,"Description: ",-1),Je=e("b",null,"DOI: ",-1),We=["href"],Ke=e("b",null,"Origins DOI: ",-1),ze=["href"],Ge={class:"flex gap-2"},He=e("b",null,"Tags: ",-1),Qe=e("b",null,"Data URL: ",-1),Xe=["href"],Ye={style:{"list-style":"none"},class:"flex flex-column gap-1"},Ze=["href"],et={key:1,class:"styled-table"},tt={key:2,style:{"white-space":"pre"}},ot={__name:"[acronym]",setup(q){const E=J(),$=g("Unknown"),l=g(),I=g(),D=g(),U=g(),w=g(),c=g(),f=ae(),T=g({}),S=g(0),L=P(),_=W(()=>K(()=>import("./create_comment.ae3418d5.js"),["./create_comment.ae3418d5.js","./entry.c1549a97.js","./entry.076fc270.css","./menu.0f9d3c11.js","./menu.16430c06.css","./create_comment.6453e953.css"],import.meta.url)),j=i=>"/jupyter/notebooks/"+i,H=i=>{if(typeof i!="string"||!i.includes("{")||!i.includes("}"))return!1;try{return JSON.parse(i),!0}catch{return!1}},N=i=>{M(`/detail/${encodeURIComponent(i)}`)},Q=i=>{F()},F=()=>{C.get(`/api/comments/${encodeURIComponent($.value)}`).then(i=>{T.value=i.data,S.value++}).catch(i=>{E.add({severity:"error",summary:"Error while getting comments",detail:i.response.data,life:3e3})})},X=i=>{L.open(_,{props:{header:"Add Comment"},data:{belongs_to:i,parent_id:null,edit:!1,text:"",comment_id:null},onClose:()=>{F()}})},Y=i=>{C.all([C.get(`/api/datasets/${encodeURIComponent(i)}`),C.get(`/api/comments/${encodeURIComponent(i)}`)]).then(C.spread((a,O)=>{l.value=a.data.dataset,l.value.authors=l.value.authors.filter(b=>b!==""),l.value.tags=l.value.tags.filter(b=>b!==""),w.value=a.data.analysis,c.value=a.data.edit_analysis_url,I.value=a.data.related_datasets,D.value=a.data.origin_datasets,U.value=a.data.same_origin_datasets,T.value=O.data})).catch(a=>{E.add({severity:"error",summary:"Error while getting dataset",detail:a.response.data,life:3e3})})},Z=i=>{M(`/edit/${encodeURIComponent(i)}`)},ee=()=>{window.open(c.value,"_blank")},te=i=>{if(l.value.url){window.open(l.value.url,"_blank");return}else console.log("No URL - trying local file");C.get(`/api/files/${encodeURIComponent(i)}`).then(a=>{const O=new Blob([a.data],{type:a.headers["content-type"]}),b=window.URL.createObjectURL(O),h=document.createElement("a");h.href=b;let k="filename";const o=a.headers["content-disposition"].match(/filename="(.+)"/);o&&o[1]&&(k=o[1]),h.setAttribute("download",k),document.body.appendChild(h),h.click()}).catch(a=>{E.add({severity:"error",summary:"Error while downloading dataset",detail:a.response.data,life:3e3})})};return ie(()=>{$.value=decodeURIComponent(f.params.acronym),Y($.value)}),(i,a)=>{const O=A("Toast"),b=A("Badge"),h=A("Button"),k=A("Fieldset");return n(),s("div",fe,[u(O,{position:"bottom-right"}),u(de),e("h1",null,[r(" Details of "+d(t($))+" ",1),t(l).status=="requested"?(n(),s("div",be,[u(b,{value:"Requested",severity:"info"}),ke])):x("",!0)]),e("h2",ve,[u(h,{onClick:a[0]||(a[0]=o=>te(t(l).acronym)),label:"Download",icon:"pi pi-download",severity:"success"}),u(h,{onClick:a[1]||(a[1]=o=>Z(t(l).acronym)),label:"Edit Info",icon:"pi pi-pencil"}),u(h,{onClick:a[2]||(a[2]=o=>ee(t(l).acronym)),label:"Edit Analysis",icon:"pi pi-external-link",severity:"secondary"})]),u(k,{legend:"Related Datasets",toggleable:!0,collapsed:""},{default:y(()=>[e("ul",Ce,[t(D).length>0?(n(),s("div",xe,[$e,(n(!0),s(m,null,p(t(D),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>N(o)},d(o),9,De)]))),256))])):x("",!0),t(I).length>0?(n(),s("div",we,[Re,(n(!0),s(m,null,p(t(I),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>N(o)},d(o),9,Ae)]))),256))])):x("",!0),t(U).length>0?(n(),s("div",Ee,[Ie,(n(!0),s(m,null,p(t(U),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>N(o)},d(o),9,Ue)]))),256))])):x("",!0)])]),_:1}),u(k,{legend:"Details",toggleable:!0},{default:y(()=>[e("ul",Te,[e("li",Oe,[Se,(n(!0),s(m,null,p(t(l).acronym_aliases,o=>(n(),R(t(V),null,{default:y(()=>[r(d(o),1)]),_:2},1024))),256))]),e("li",null,[je,r(" "+d(t(l).title),1)]),e("li",null,[Be,r(" "+d(t(l).paper_title),1)]),e("li",Le,[Ne,(n(!0),s(m,null,p(t(l).authors,o=>(n(),R(t(V),null,{default:y(()=>[r(d(o),1)]),_:2},1024))),256))]),e("li",null,[Ve,r(),u(z,{datetime:t(l).date_submitted},null,8,["datetime"])]),e("li",null,[qe,e("ul",null,[e("li",null,[Fe,r(" "+d(t(l).submitter.name),1)]),e("li",null,[Me,r(" "+d(t(l).submitter.email),1)])])]),e("li",null,[Pe,r(" "+d(t(l).description),1)]),e("li",null,[Je,r(),e("a",{href:t(l).doi,target:"_blank"},d(t(l).doi),9,We)]),e("li",null,[Ke,r(),e("a",{href:t(l).origins_doi,target:"_blank"},d(t(l).origins_doi),9,ze)]),e("li",Ge,[He,(n(!0),s(m,null,p(t(l).tags,o=>(n(),R(t(V),null,{default:y(()=>[r(d(o),1)]),_:2},1024))),256))]),e("li",null,[Qe,r(),e("a",{href:t(l).url,target:"_blank"},d(t(l).url),9,Xe)])])]),_:1}),u(k,{legend:"Comment Section",toggleable:!0,collapsed:""},{default:y(()=>[u(h,{label:"Add Comment",icon:"pi pi-plus",severity:"secondary",onClick:a[3]||(a[3]=o=>X(t(l).acronym)),style:{"margin-bottom":"0.3em"}}),(n(),R(G,{onSignal:Q,comments:t(T),key:t(S)},null,8,["comments"]))]),_:1}),(n(!0),s(m,null,p(t(w).analysis,(o,B)=>(n(),s(m,null,[typeof o=="object"?(n(),R(k,{key:0,legend:B.replaceAll("_"," "),toggleable:!0},{default:y(()=>[e("ul",Ye,[(n(!0),s(m,null,p(o,(v,ne)=>(n(),s("li",null,[e("b",null,d(ne.replaceAll("_"," "))+": ",1),typeof v=="string"&&v.endsWith(".ipynb")?(n(),s("a",{key:0,href:j(t(l).acronym+"/"+v),target:"_blank"},d(v),9,Ze)):H(v)?(n(),s("table",et,[e("tbody",null,[(n(!0),s(m,null,p(JSON.parse(v),(le,se)=>(n(),s("tr",null,[e("td",null,d(se),1),e("td",null,d(le),1)]))),256))])])):(n(),s("span",tt,d(v),1))]))),256))])]),_:2},1032,["legend"])):x("",!0)],64))),256))])}}};export{ot as default};
