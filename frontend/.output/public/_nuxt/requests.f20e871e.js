import{a as k,e as x,b as S,f as $,r as f,h as A,i as n,j as M,k as a,w as h,u as s,l as B,m as u,o as U,F as V,B as F,d as I,_ as N}from"./entry.d3730132.js";import{a as _}from"./axios.4a70c6fc.js";import{M as O}from"./menu.49480bef.js";const P=u("h1",null," Requested For Analysis ",-1),H={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},L={class:"p-input-icon-left"},z=u("i",{class:"pi pi-search"},null,-1),X={__name:"requests",setup(G){k();const i=x(),g=S(),b=$(),o=f([]),y=I(()=>N(()=>import("./upload.9f03129e.js"),["./upload.9f03129e.js","./entry.d3730132.js","./entry.076fc270.css","./axios.4a70c6fc.js","./upload.6918fed0.css"],import.meta.url)),m=f({global:{value:null,matchMode:V.CONTAINS}}),v=f([]),d=()=>{_.get("/api/requests").then(t=>{v.value=t.data}).catch(t=>{i.add({severity:"error",summary:"Error while getting requests",detail:t.response.data,life:3e3})})};A(()=>d());const D=()=>{let t=[];o.value.forEach(e=>{t.push(e.title)}),console.log(t),g.require({message:`Are you sure you want to reject ${t.length} datasets?`,header:"Reject Confirmation",icon:"pi pi-exclemation-triangle",accept:()=>{o.value=null,t.forEach(e=>{_.delete(`/api/requests/${e}`).then(()=>{i.add({severity:"success",summary:"Rejection Successful",detail:`Dataset ${e} rejected.`,life:3e3}),d()}).catch(c=>{i.add({severity:"error",summary:"Error while rejecting request",detail:c.response.data,life:3e3})})})}})},C=()=>{let t=[];o.value.forEach(e=>{t.push(e.title)}),console.log(t),t.forEach(e=>{_.head(`/api/requests/${e}`).then(()=>{i.add({severity:"success",summary:"Approval Successful",detail:`Request ${e} approved.`}),d()}).catch(c=>{i.add({severity:"error",summary:"Error while accepting request",detail:c.response.data,life:3e3})})})},q=t=>{F(`/detail/${encodeURIComponent(t)}`)},w=()=>{b.open(y,{props:{header:"Submit Dataset",modal:!0},onClose:t=>{const e=t.data;e&&(i.add({severity:"success",summary:"Upload Successful",detail:`File ${e} uploaded successfully.`,life:3e3}),d())}})};return(t,e)=>{const c=n("ConfirmDialog"),E=n("Toast"),p=n("Button"),R=n("InputText"),r=n("Column"),T=n("DataTable"),j=n("DynamicDialog");return U(),M("div",null,[a(O),P,a(c),a(T,{value:s(v),scrollable:"",scrollHeight:"500px",filters:s(m),selection:s(o),"onUpdate:selection":e[3]||(e[3]=l=>B(o)?o.value=l:null)},{header:h(()=>[u("div",H,[u("div",null,[a(p,{label:"Submit Dataset",icon:"pi pi-ticket",class:"mr-2",onClick:w}),a(p,{label:"Approve",icon:"pi pi-check",severity:"success",class:"mr-2",onClick:e[0]||(e[0]=l=>C()),disabled:!s(o)||!s(o).length},null,8,["disabled"]),a(p,{label:"Reject",icon:"pi pi-ban",severity:"danger",onClick:e[1]||(e[1]=l=>D()),disabled:!s(o)||!s(o).length},null,8,["disabled"])]),u("span",L,[z,a(R,{modelValue:s(m).global.value,"onUpdate:modelValue":e[2]||(e[2]=l=>s(m).global.value=l),placeholder:"Search..."},null,8,["modelValue"])])])]),default:h(()=>[a(E,{position:"bottom-right"}),a(r,{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(r,{field:"acronym",header:"Dataset Acronym",sortable:""}),a(r,{field:"title",header:"Dataset Title",sortable:""}),a(r,{field:"submitter.name",header:"Submitter Name"}),a(r,{field:"submitter.email",header:"Submitter Email"}),a(r,null,{body:h(l=>[a(p,{onClick:J=>q(l.data.acronym),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection"]),a(j)])}}};export{X as default};
