import{a as P,b as W,i as ne,r as I,o as n,e as l,f as b,c as A,w as x,h as m,t as r,j as e,k as d,l as p,F as h,d as J,_ as K,m as se,p as le,q as g,s as oe,v as ae,u as s,x as M,y as F}from"./entry.f1d49704.js";import{a as R,M as ie}from"./menu.9dc9b1ab.js";import{_ as z}from"./date.82a89d4e.js";const re={key:0},ce={key:1},de=e("hr",null,null,-1),ue={class:"flex justify-content-between flex-wrap"},_e={key:0},me={key:0},pe=["onClick"],he=["onClick"],ye=["onClick"],G={__name:"comments",props:{comments:{type:[Object,Array],required:!0}},emits:["signal"],setup(O,{emit:E}){const D=P(),t=W();ne("dialogRef");const U=J(()=>K(()=>import("./create_comment.35768c78.js"),["./create_comment.35768c78.js","./entry.f1d49704.js","./entry.076fc270.css","./menu.9dc9b1ab.js","./menu.d6419823.css","./create_comment.6453e953.css"],import.meta.url)),w=(c,y=!1)=>{console.log(c),D.open(U,{props:{header:y?"Edit Comment":"Add Comment"},data:{belongs_to:c.belongs_to,comment_id:c.id,edit:y,text:y?c.text:""},onClose:()=>{k(c.belongs_to)}})},j=c=>{R.delete("/api/comments/"+c.id).then(()=>{t.add({severity:"success",summary:"Success",detail:"Comment deleted",life:3e3}),k(c.belongs_to)}).catch(y=>{t.add({severity:"error",summary:"Error",detail:y,life:3e3})})},k=c=>{E("signal",c)};return(c,y)=>{const u=G,v=I("AccordionTab"),S=I("Accordion");return n(!0),l(h,null,b(O.comments,_=>(n(),A(S,{activeIndex:0,style:{"margin-top":"0.5rem","margin-bottom":"0.5rem"}},{default:x(()=>[m(v,{header:_.deleted?"<deleted>":_.author},{default:x(()=>[_.deleted?(n(),l("span",re,"<deleted>")):(n(),l("span",ce,r(_.text),1)),de,e("small",ue,[e("div",null,[m(z,{datetime:_.date},null,8,["datetime"]),d(),_.edited?(n(),l("span",_e," | edited ")):p("",!0)]),_.deleted?p("",!0):(n(),l("div",me,[e("span",{class:"link",onClick:L=>w(_)},"Reply",8,pe),d(" | "),e("span",{class:"link",onClick:L=>w(_,!0)},"Edit",8,he),d(" | "),e("span",{class:"link",onClick:L=>j(_)},"Delete",8,ye)]))]),m(u,{onSignal:k,comments:_.children},null,8,["comments"])]),_:2},1032,["header"])]),_:2},1024))),256)}}},fe={style:{"list-style":"none"},class:"flex flex-column gap-1"},ge={key:0},be={key:0},ke={key:0,class:"pi pi-info-circle"},ve=["href"],Ce={key:2,class:"styled-table"},$e={key:3,style:{"white-space":"pre"}},xe={key:0},H={__name:"analysis",props:{acronym:{type:String,required:!0},analysis:{type:Object,required:!0}},setup(O){const E=t=>"/jupyter/notebooks/"+t,D=t=>{if(typeof t!="string"||!t.includes("{")||!t.includes("}"))return!1;try{return JSON.parse(t),!0}catch{return!1}};return(t,U)=>{const w=H,j=I("Fieldset"),k=se("tooltip");return n(!0),l(h,null,b(O.analysis,(c,y)=>(n(),l(h,null,[typeof c=="object"?(n(),A(j,{key:0,legend:y.replaceAll("_"," "),toggleable:!0,style:{"margin-bottom":"1em"}},{default:x(()=>[e("ul",fe,[(n(!0),l(h,null,b(c,(u,v)=>(n(),l(h,null,[v.endsWith("_info")?p("",!0):(n(),l("li",ge,[typeof u!="object"?(n(),l("b",be,[c[v+"_info"]?le((n(),l("i",ke,null,512)),[[k,c[v+"_info"],void 0,{left:!0}]]):p("",!0),d(" "+r(v.replaceAll("_"," "))+": ",1)])):p("",!0),typeof u=="string"&&u.endsWith(".ipynb")?(n(),l("a",{key:1,href:E(O.acronym+"/"+u),target:"_blank"},r(u),9,ve)):D(u)?(n(),l("table",Ce,[e("tbody",null,[(n(!0),l(h,null,b(JSON.parse(u),(S,_)=>(n(),l("tr",null,[e("td",null,r(_),1),e("td",null,r(S),1)]))),256))])])):typeof u!="object"?(n(),l("span",$e,r(u),1)):p("",!0)]))],64))),256)),typeof c=="object"?(n(),l("span",xe,[m(w,{analysis:c,acronym:O.acronym},null,8,["analysis","acronym"])])):p("",!0)])]),_:2},1032,["legend"])):p("",!0)],64))),256)}}};const De={class:"flex flex-column gap-3"},we={key:0},Re=e("br",null,null,-1),Ae={class:"flex gap-2"},Ee={class:"flex flex-column gap-2"},Ue={key:0},je=e("b",null,"Origin Datasets",-1),Ie=["onClick"],Oe={key:1},Te=e("b",null,"Related Datasets",-1),Se=["onClick"],Le={key:2},Be=e("b",null,"Datasets With the Same Origin",-1),Fe=["onClick"],Ne={style:{"list-style":"none"},class:"flex flex-column gap-2"},qe={class:"flex gap-2"},Ve=e("b",null,"Acronym Aliases: ",-1),Me=e("b",null,"Dataset Title: ",-1),Pe=e("b",null,"Paper Title: ",-1),We={class:"flex gap-2"},Je=e("b",null,"Authors: ",-1),Ke=e("b",null,"Date Submitted: ",-1),ze=e("b",null,"Submitter: ",-1),Ge=e("b",null,"Name: ",-1),He=e("b",null,"Email: ",-1),Qe=e("b",null,"Description: ",-1),Xe=e("b",null,"Format: ",-1),Ye=e("b",null,"DOI: ",-1),Ze=["href"],et=e("b",null,"Origins DOI: ",-1),tt=["href"],nt={class:"flex gap-2"},st=e("b",null,"Tags: ",-1),lt=e("b",null,"Data URL: ",-1),ot=["href"],at=e("b",null,"Data File: ",-1),dt={__name:"[acronym]",setup(O){const E=W(),D=g("Unknown"),t=g(),U=g(),w=g(),j=g(),k=g(),c=g(),y=oe(),u=g({}),v=g(0),S=g(null),_=P(),L=J(()=>K(()=>import("./create_comment.35768c78.js"),["./create_comment.35768c78.js","./entry.f1d49704.js","./entry.076fc270.css","./menu.9dc9b1ab.js","./menu.d6419823.css","./create_comment.6453e953.css"],import.meta.url)),B=a=>{M(`/detail/${encodeURIComponent(a)}`)},Q=a=>{N()},N=()=>{R.get(`/api/comments/${encodeURIComponent(D.value)}`).then(a=>{u.value=a.data,v.value++}).catch(a=>{E.add({severity:"error",summary:"Error while getting comments",detail:a.response.data,life:3e3})})},X=a=>{_.open(L,{props:{header:"Add Comment"},data:{belongs_to:a,parent_id:null,edit:!1,text:"",comment_id:null},onClose:()=>{N()}})},Y=a=>{R.all([R.get(`/api/datasets/${encodeURIComponent(a)}`),R.get(`/api/comments/${encodeURIComponent(a)}`)]).then(R.spread((o,C)=>{t.value=o.data.dataset,t.value.authors=t.value.authors.filter($=>$!==""),t.value.acronym_aliases=t.value.acronym_aliases.filter($=>$!==""),t.value.tags=t.value.tags.filter($=>$!==""),k.value=o.data.dataset.analysis,c.value=o.data.edit_analysis_url,U.value=o.data.related_datasets,w.value=o.data.origin_datasets,j.value=o.data.same_origin_datasets,u.value=C.data,console.log(k.value)})).catch(o=>{E.add({severity:"error",summary:"Error while getting dataset",detail:o.response.data,life:3e3})})},Z=a=>{M(`/edit/${encodeURIComponent(a)}`)},ee=()=>{window.open(c.value,"_blank")},q=(a,o=!1)=>{let C=a;if(a)return/^https?:\/\//i.test(a)||(C=`https://${a}`),o?window.open(C,"_blank"):C;console.log("No URL - trying local file")},te=a=>{R.get(`/api/files/${encodeURIComponent(a)}`).then(o=>{const C=new Blob([o.data],{type:o.headers["content-type"]}),$=window.URL.createObjectURL(C),f=document.createElement("a");f.href=$;let T="filename";const i=o.headers["content-disposition"].match(/filename="(.+)"/);i&&i[1]&&(T=i[1]),f.setAttribute("download",T),document.body.appendChild(f),f.click()}).catch(o=>{E.add({severity:"error",summary:"Error while downloading dataset",detail:o.response.data,life:3e3})})};return ae(()=>{D.value=decodeURIComponent(y.params.acronym),Y(D.value),R.get("/api/users/me").then(a=>{console.log(a.data),S.value=a.data}).catch()}),(a,o)=>{const C=I("Toast"),$=I("Badge"),f=I("Button"),T=I("Fieldset");return n(),l("div",De,[m(C,{position:"bottom-right"}),m(ie),e("h1",null,[d(" Details of "+r(s(D))+" ",1),s(t).status=="requested"?(n(),l("div",we,[m($,{value:"Requested",severity:"info"}),Re])):p("",!0)]),e("h2",Ae,[s(t).filename?(n(),A(f,{key:0,onClick:o[0]||(o[0]=i=>te(s(t).acronym)),label:"Download",icon:"pi pi-download",severity:"success"})):p("",!0),s(t).url?(n(),A(f,{key:1,onClick:o[1]||(o[1]=i=>q(s(t).url,!0)),label:"Open URL",icon:"pi pi-link",severity:"success"})):p("",!0),m(f,{onClick:o[2]||(o[2]=i=>Z(s(t).acronym)),label:"Edit Info",icon:"pi pi-pencil"}),m(f,{onClick:o[3]||(o[3]=i=>ee(s(t).acronym)),label:"Edit Analysis",icon:"pi pi-external-link",severity:"secondary"})]),m(T,{legend:"Related Datasets",toggleable:!0,collapsed:""},{default:x(()=>[e("ul",Ee,[s(w).length>0?(n(),l("div",Ue,[je,(n(!0),l(h,null,b(s(w),i=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:V=>B(i)},r(i),9,Ie)]))),256))])):p("",!0),s(U).length>0?(n(),l("div",Oe,[Te,(n(!0),l(h,null,b(s(U),i=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:V=>B(i)},r(i),9,Se)]))),256))])):p("",!0),s(j).length>0?(n(),l("div",Le,[Be,(n(!0),l(h,null,b(s(j),i=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:V=>B(i)},r(i),9,Fe)]))),256))])):p("",!0)])]),_:1}),m(T,{legend:"Details",toggleable:!0},{default:x(()=>[e("ul",Ne,[e("li",qe,[Ve,(n(!0),l(h,null,b(s(t).acronym_aliases,i=>(n(),A(s(F),null,{default:x(()=>[d(r(i),1)]),_:2},1024))),256))]),e("li",null,[Me,d(" "+r(s(t).title),1)]),e("li",null,[Pe,d(" "+r(s(t).paper_title),1)]),e("li",We,[Je,(n(!0),l(h,null,b(s(t).authors,i=>(n(),A(s(F),null,{default:x(()=>[d(r(i),1)]),_:2},1024))),256))]),e("li",null,[Ke,d(),m(z,{datetime:s(t).date_submitted},null,8,["datetime"])]),e("li",null,[ze,e("ul",null,[e("li",null,[Ge,d(" "+r(s(t).submitter.name),1)]),e("li",null,[He,d(" "+r(s(t).submitter.email),1)])])]),e("li",null,[Qe,d(" "+r(s(t).description),1)]),e("li",null,[Xe,d(" "+r(s(t).format),1)]),e("li",null,[Ye,d(),e("a",{href:s(t).doi,target:"_blank"},r(s(t).doi),9,Ze)]),e("li",null,[et,d(),e("a",{href:s(t).origins_doi,target:"_blank"},r(s(t).origins_doi),9,tt)]),e("li",nt,[st,(n(!0),l(h,null,b(s(t).tags,i=>(n(),A(s(F),null,{default:x(()=>[d(r(i),1)]),_:2},1024))),256))]),e("li",null,[lt,d(),e("a",{href:q(s(t).url),about:"_blank"},r(s(t).url),9,ot)]),e("li",null,[at,d(" "+r(s(t).filename),1)])])]),_:1}),m(T,{legend:"Discussion",toggleable:!0,collapsed:""},{default:x(()=>[m(f,{label:"Add Comment",icon:"pi pi-plus",severity:"secondary",onClick:o[4]||(o[4]=i=>X(s(t).acronym)),style:{"margin-bottom":"0.3em"}}),(n(),A(G,{onSignal:Q,comments:s(u),key:s(v)},null,8,["comments"]))]),_:1}),m(H,{analysis:s(k).analysis,acronym:s(t).acronym},null,8,["analysis","acronym"])])}}};export{dt as default};
