import{a as P,b as W,i as oe,r as j,o as n,e as l,f as C,c as A,w as D,h as p,t as r,j as e,k as u,l as h,F as f,d as J,_ as K,m as le,p as se,q as v,s as ae,v as ie,u as t,x as M,y as N}from"./entry.1872c7b9.js";import{a as U,M as re}from"./menu.49f8b601.js";import{_ as z}from"./date.ce476d6b.js";const ce={key:0},de={key:1},ue=e("hr",null,null,-1),_e={class:"flex justify-content-between flex-wrap"},me={key:0},pe={key:0},ye=["onClick"],he=["onClick"],ge=["onClick"],G={__name:"comments",props:{comments:{type:[Object,Array],required:!0}},emits:["signal"],setup(O,{emit:I}){const $=P(),_=W();oe("dialogRef");const o=J(()=>K(()=>import("./create_comment.54403acc.js"),["./create_comment.54403acc.js","./entry.1872c7b9.js","./entry.076fc270.css","./menu.49f8b601.js","./menu.d6419823.css","./create_comment.6453e953.css"],import.meta.url)),R=(c,b=!1)=>{console.log(c),$.open(o,{props:{header:b?"Edit Comment":"Add Comment"},data:{belongs_to:c.belongs_to,comment_id:c.id,edit:b,text:b?c.text:""},onClose:()=>{x(c.belongs_to)}})},E=c=>{U.delete("/api/comments/"+c.id).then(()=>{_.add({severity:"success",summary:"Success",detail:"Comment deleted",life:3e3}),x(c.belongs_to)}).catch(b=>{_.add({severity:"error",summary:"Error",detail:b,life:3e3})})},x=c=>{I("signal",c)};return(c,b)=>{const y=G,k=j("AccordionTab"),T=j("Accordion");return n(!0),l(f,null,C(O.comments,m=>(n(),A(T,{activeIndex:0,style:{"margin-top":"0.5rem","margin-bottom":"0.5rem"}},{default:D(()=>[p(k,{header:m.deleted?"<deleted>":m.author},{default:D(()=>[m.deleted?(n(),l("span",ce,"<deleted>")):(n(),l("span",de,r(m.text),1)),ue,e("small",_e,[e("div",null,[p(z,{datetime:m.date},null,8,["datetime"]),u(),m.edited?(n(),l("span",me," | edited ")):h("",!0)]),m.deleted?h("",!0):(n(),l("div",pe,[e("span",{class:"link",onClick:B=>R(m)},"Reply",8,ye),u(" | "),e("span",{class:"link",onClick:B=>R(m,!0)},"Edit",8,he),u(" | "),e("span",{class:"link",onClick:B=>E(m)},"Delete",8,ge)]))]),p(y,{onSignal:x,comments:m.children},null,8,["comments"])]),_:2},1032,["header"])]),_:2},1024))),256)}}},fe={style:{"list-style":"none"},class:"flex flex-column gap-1"},be={key:0},ve={key:0},ke={key:0,class:"pi pi-info-circle"},Ce=["href"],$e={key:2,class:"styled-table"},xe={key:3,style:{"white-space":"pre"}},De={key:0},H={__name:"analysis",props:{acronym:{type:String,required:!0},analysis:{type:Object,required:!0}},setup(O){const I=_=>"/jupyter/notebooks/"+_,$=_=>{if(typeof _!="string"||!_.includes("{")||!_.includes("}"))return!1;try{return JSON.parse(_),!0}catch{return!1}};return(_,o)=>{const R=H,E=j("Fieldset"),x=le("tooltip");return n(!0),l(f,null,C(O.analysis,(c,b)=>(n(),l(f,null,[typeof c=="object"?(n(),A(E,{key:0,legend:b.replaceAll("_"," "),toggleable:!0,style:{"margin-bottom":"1em"}},{default:D(()=>[e("ul",fe,[(n(!0),l(f,null,C(c,(y,k)=>(n(),l(f,null,[k.endsWith("_info")?h("",!0):(n(),l("li",be,[typeof y!="object"?(n(),l("b",ve,[c[k+"_info"]?se((n(),l("i",ke,null,512)),[[x,c[k+"_info"],void 0,{left:!0}]]):h("",!0),u(" "+r(k.replaceAll("_"," "))+": ",1)])):h("",!0),typeof y=="string"&&y.endsWith(".ipynb")?(n(),l("a",{key:1,href:I(O.acronym+"/"+y),target:"_blank"},r(y),9,Ce)):$(y)?(n(),l("table",$e,[e("tbody",null,[(n(!0),l(f,null,C(JSON.parse(y),(T,m)=>(n(),l("tr",null,[e("td",null,r(m),1),e("td",null,r(T),1)]))),256))])])):typeof y!="object"?(n(),l("span",xe,r(y),1)):h("",!0)]))],64))),256)),typeof c=="object"?(n(),l("span",De,[p(R,{analysis:c,acronym:O.acronym},null,8,["analysis","acronym"])])):h("",!0)])]),_:2},1032,["legend"])):h("",!0)],64))),256)}}};const Re={class:"flex flex-column gap-3"},we={key:0},Ue=e("br",null,null,-1),Ae={class:"flex gap-2"},Ie={class:"flex flex-column gap-2"},Ee={key:0},je=e("b",null,"Origin Datasets",-1),Oe=["onClick"],Te={key:1},Se=e("b",null,"Related Datasets",-1),Le=["onClick"],Be={key:2},Fe=e("b",null,"Datasets With the Same Origin",-1),Ne=["onClick"],qe={style:{"list-style":"none"},class:"flex flex-column gap-2"},Ve={class:"flex gap-2"},Me=e("b",null,"Acronym Aliases: ",-1),Pe=e("b",null,"Dataset Title: ",-1),We=e("b",null,"Paper Title: ",-1),Je={class:"flex gap-2"},Ke=e("b",null,"Authors: ",-1),ze=e("b",null,"Date Submitted: ",-1),Ge=e("b",null,"Submitter: ",-1),He=e("b",null,"Name: ",-1),Qe=e("b",null,"Email: ",-1),Xe=e("b",null,"Description: ",-1),Ye=e("b",null,"Format: ",-1),Ze=e("b",null,"DOI: ",-1),et=["href"],tt=e("b",null,"Origins DOI: ",-1),nt=["href"],ot={class:"flex gap-2"},lt=e("b",null,"Tags: ",-1),st=e("b",null,"Data URL: ",-1),at=["href"],it=e("b",null,"Data File: ",-1),ut={__name:"[aliases]",setup(O){const I=W(),$=v("Unknown"),_=v("Unknown"),o=v(),R=v(),E=v(),x=v(),c=v(),b=v(),y=ae(),k=v({}),T=v(0),m=v(null),B=P(),Q=J(()=>K(()=>import("./create_comment.54403acc.js"),["./create_comment.54403acc.js","./entry.1872c7b9.js","./entry.076fc270.css","./menu.49f8b601.js","./menu.d6419823.css","./create_comment.6453e953.css"],import.meta.url)),F=(a,i)=>{i==""&&(i=a),M(`/detail/${encodeURIComponent(a)}/${encodeURIComponent(i)}`)},X=a=>{q()},q=()=>{U.get(`/api/comments/${encodeURIComponent($.value)}`).then(a=>{k.value=a.data,T.value++}).catch(a=>{I.add({severity:"error",summary:"Error while getting comments",detail:a.response.data,life:3e3})})},Y=a=>{B.open(Q,{props:{header:"Add Comment"},data:{belongs_to:a,parent_id:null,edit:!1,text:"",comment_id:null},onClose:()=>{q()}})},Z=(a,i)=>{console.log("get"),console.log(a),console.log(i),U.all([U.get(`/api/datasets/${encodeURIComponent(a)}/${encodeURIComponent(i)}`),U.get(`/api/comments/${encodeURIComponent(a)}`)]).then(U.spread((d,L)=>{o.value=d.data.dataset,o.value.authors=o.value.authors.filter(g=>g!==""),o.value.acronym_aliases=o.value.acronym_aliases.filter(g=>g!==""),o.value.tags=o.value.tags.filter(g=>g!==""),c.value=d.data.dataset.analysis,b.value=d.data.edit_analysis_url,R.value=d.data.related_datasets,E.value=d.data.origin_datasets,x.value=d.data.same_origin_datasets,k.value=L.data,console.log(c.value)})).catch(d=>{I.add({severity:"error",summary:"Error while getting dataset",detail:d.response.data,life:3e3})})},ee=(a,i)=>{i==""&&(i=a),M(`/edit/${encodeURIComponent(a)}/${encodeURIComponent(i)}`)},te=()=>{window.open(b.value,"_blank")},V=(a,i=!1)=>{let d=a;if(a)return/^https?:\/\//i.test(a)||(d=`https://${a}`),i?window.open(d,"_blank"):d;console.log("No URL - trying local file")},ne=(a,i)=>{U.get(`/api/files/${encodeURIComponent(a)}/${encodeURIComponent(i)}`).then(d=>{const L=new Blob([d.data],{type:d.headers["content-type"]}),g=window.URL.createObjectURL(L),w=document.createElement("a");w.href=g;let s="filename";const S=d.headers["content-disposition"].match(/filename="(.+)"/);S&&S[1]&&(s=S[1]),w.setAttribute("download",s),document.body.appendChild(w),w.click()}).catch(d=>{I.add({severity:"error",summary:"Error while downloading dataset",detail:d.response.data,life:3e3})})};return ie(()=>{$.value=decodeURIComponent(y.params.acronym),_.value=decodeURIComponent(y.params.aliases),_.value==$.value&&(_.value=""),Z($.value,_.value),U.get("/api/users/me").then(a=>{console.log(a.data),m.value=a.data}).catch()}),(a,i)=>{const d=j("Toast"),L=j("Badge"),g=j("Button"),w=j("Fieldset");return n(),l("div",Re,[p(d,{position:"bottom-right"}),p(re),e("h1",null,[u(" Details of "+r(t($))+" ",1),t(o).status=="requested"?(n(),l("div",we,[p(L,{value:"Requested",severity:"info"}),Ue])):h("",!0)]),e("h2",Ae,[t(o).filename?(n(),A(g,{key:0,onClick:i[0]||(i[0]=s=>ne(t(o).acronym,t(o).acronym_aliases)),label:"Download",icon:"pi pi-download",severity:"success"})):h("",!0),t(o).url?(n(),A(g,{key:1,onClick:i[1]||(i[1]=s=>V(t(o).url,!0)),label:"Open URL",icon:"pi pi-link",severity:"success"})):h("",!0),p(g,{onClick:i[2]||(i[2]=s=>ee(t(o).acronym,t(o).acronym_aliases)),label:"Edit Info",icon:"pi pi-pencil"}),p(g,{onClick:i[3]||(i[3]=s=>te(t(o).acronym)),label:"Edit Analysis",icon:"pi pi-external-link",severity:"secondary"})]),p(w,{legend:"Related Datasets",toggleable:!0,collapsed:""},{default:D(()=>[e("ul",Ie,[t(E).length>0?(n(),l("div",Ee,[je,(n(!0),l(f,null,C(t(E),s=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:S=>F(s.acronym,s.aliases)},r(s.acronym+"["+s.aliases+"]"),9,Oe)]))),256))])):h("",!0),t(R).length>0?(n(),l("div",Te,[Se,(n(!0),l(f,null,C(t(R),s=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:S=>F(s.acronym,s.aliases)},r(s.acronym+"["+s.aliases+"]"),9,Le)]))),256))])):h("",!0),t(x).length>0?(n(),l("div",Be,[Fe,(n(!0),l(f,null,C(t(x),s=>(n(),l("li",null,[e("span",{class:"detail-link",onClick:S=>F(s.acronym,s.aliases)},r(s.acronym+"["+s.aliases+"]"),9,Ne)]))),256))])):h("",!0)])]),_:1}),p(w,{legend:"Details",toggleable:!0},{default:D(()=>[e("ul",qe,[e("li",Ve,[Me,(n(!0),l(f,null,C(t(o).acronym_aliases,s=>(n(),A(t(N),null,{default:D(()=>[u(r(s),1)]),_:2},1024))),256))]),e("li",null,[Pe,u(" "+r(t(o).title),1)]),e("li",null,[We,u(" "+r(t(o).paper_title),1)]),e("li",Je,[Ke,(n(!0),l(f,null,C(t(o).authors,s=>(n(),A(t(N),null,{default:D(()=>[u(r(s),1)]),_:2},1024))),256))]),e("li",null,[ze,u(),p(z,{datetime:t(o).date_submitted},null,8,["datetime"])]),e("li",null,[Ge,e("ul",null,[e("li",null,[He,u(" "+r(t(o).submitter.name),1)]),e("li",null,[Qe,u(" "+r(t(o).submitter.email),1)])])]),e("li",null,[Xe,u(" "+r(t(o).description),1)]),e("li",null,[Ye,u(" "+r(t(o).format),1)]),e("li",null,[Ze,u(),e("a",{href:t(o).doi,target:"_blank"},r(t(o).doi),9,et)]),e("li",null,[tt,u(),e("a",{href:t(o).origins_doi,target:"_blank"},r(t(o).origins_doi),9,nt)]),e("li",ot,[lt,(n(!0),l(f,null,C(t(o).tags,s=>(n(),A(t(N),null,{default:D(()=>[u(r(s),1)]),_:2},1024))),256))]),e("li",null,[st,u(),e("a",{href:V(t(o).url),about:"_blank"},r(t(o).url),9,at)]),e("li",null,[it,u(" "+r(t(o).filename),1)])])]),_:1}),p(w,{legend:"Discussion",toggleable:!0,collapsed:""},{default:D(()=>[p(g,{label:"Add Comment",icon:"pi pi-plus",severity:"secondary",onClick:i[4]||(i[4]=s=>Y(t(o).acronym)),style:{"margin-bottom":"0.3em"}}),(n(),A(G,{onSignal:X,comments:t(k),key:t(T)},null,8,["comments"]))]),_:1}),p(H,{analysis:t(c).analysis,acronym:t(o).acronym},null,8,["analysis","acronym"])])}}};export{ut as default};
