const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Cs_jRAFn.js","./NsHqofmf.js","./DW_MHI2K.js","./upload.CMNI5XCl.css"])))=>i.map(i=>d[i]);
import{u as z,m as G,n as H,p as K,r as _,q as Q,c as p,b as t,a as m,w as o,s as T,v as r,x as X,o as i,y as Y,z as Z,A as P,C as g,W as k,U as I,B as b,ag as ee,t as ae,ae as te,D as se,E as le,F as ne,G as oe,H as ie,af as re,I as de,J as ce}from"./NsHqofmf.js";import{a as U}from"./DW_MHI2K.js";import{M as ue}from"./BhSyuozP.js";const pe={class:"flex flex-wrap gap-2 items-center justify-between"},me={key:0,class:"flex gap-1"},fe=["href"],_e={key:0,class:"flex gap-1"},he={class:"flex gap-1"},ye={key:0,class:"flex gap-1"},ve={class:"flex gap-1"},De={__name:"index",setup(ge){z();const B=G(),h=H(),M=K(),x=_(null),c=_([]),C=_([]),D=_({global:{value:null,matchMode:"contains"}}),y=_([]),F=de(()=>ce(()=>import("./Cs_jRAFn.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),S=a=>a=="Requested"?"info":a=="In Progress"?"warn":a=="Completed"?"success":"danger",O=a=>a.startsWith("http://")||a.startsWith("https://")||a.startsWith("doi.org")?a:"https://doi.org/"+a,$=()=>{U.get("/api/datasets").then(a=>{console.log(a.data),y.value=a.data.filter(e=>e.is_child==!1),console.log(y.value),y.value.forEach(e=>{console.log("dataset: ",e," (children: )",e.version_children.length),e.metadata=JSON.stringify(e,function(v,d){if(d&&typeof d=="object"){var u={};for(var f in d)Object.hasOwnProperty.call(d,f)&&(u[f&&f.replaceAll("_"," ")]=d[f]);return u}return d})})}).catch(a=>{h.add({severity:"error",summary:"Error while getting datasets",detail:a.response.data,life:3e3})})},R=(a,e)=>{console.log(a,e),e==""&&(e="*"),re(`/detail/${encodeURIComponent(a)}/${encodeURIComponent(e)}`)},N=()=>{let a=[];c.value.forEach(e=>{a.push({acronym:e.acronym,versions:e.versions})}),B.require({message:`Are you sure you want to delete ${a.length} files`,header:"Delete Confirmation",icon:"pi pi-exclemation-triangle",accept:()=>{c.value=null,a.forEach(e=>{U.delete(`/api/datasets/${encodeURIComponent(e.acronym)}/${encodeURIComponent(e.versions)}`).then(()=>{h.add({severity:"success",summary:"Delete Successful",detail:`Dataset ${e.acronym}/${e.versions} deleted successfully.`,life:3e3}),$()}).catch(v=>{h.add({severity:"error",summary:"Delete Failed",detail:v.response.data,life:3e3})})})}})},W=()=>{M.open(F,{props:{header:"Submit Dataset",modal:!0},onClose:a=>{const e=a.data;e&&(h.add({severity:"success",summary:"Upload Successful",detail:`File ${e} uploaded successfully.`,life:3e3}),$())}})};Q(()=>{$(),U.get("/api/users/me").then(a=>{x.value=a.data}).catch()});const j=a=>a.version_children.length>0?"":"no-expander";return(a,e)=>{const v=Y,d=Z,u=se,f=ne,q=oe,J=le,n=P,w=ee,V=te,A=X,L=ie;return i(),p("div",null,[t(v,{position:"bottom-right"}),t(ue),e[5]||(e[5]=m("h1",{class:"m-4 text-3xl font-bold"},"Dataset Catalog",-1)),t(d),t(A,{value:r(y),scrollable:"",filters:r(D),selection:r(c),"onUpdate:selection":e[2]||(e[2]=s=>T(c)?c.value=s:null),"expanded-rows":r(C),"onUpdate:expandedRows":e[3]||(e[3]=s=>T(C)?C.value=s:null),rowClass:j},{header:o(()=>[m("div",pe,[m("div",null,[t(u,{label:"Submit Dataset",icon:"pi pi-ticket",class:"mr-2",onClick:W}),r(x)&&r(x).is_admin?(i(),b(u,{key:0,label:"Delete",icon:"pi pi-trash",class:"mr-2",severity:"danger",onClick:e[0]||(e[0]=s=>N()),disabled:!r(c)||!r(c).length},null,8,["disabled"])):g("",!0)]),t(J,null,{default:o(()=>[t(f,null,{default:o(()=>e[4]||(e[4]=[m("i",{class:"pi pi-search"},null,-1)])),_:1}),t(q,{modelValue:r(D).global.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r(D).global.value=s),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),expansion:o(s=>[t(A,{class:"w-full",value:s.data.version_children.filter(l=>l.versions.length>0),scrollable:""},{default:o(()=>[t(n,{field:"acronym",header:"Acronym",sortable:"",hidden:""}),t(n,{field:"versions",header:"Versions",sortable:""},{body:o(l=>[l.data.versions.length>=1||l.data.versions[0]!=""?(i(),p("div",ye,[(i(!0),p(k,null,I(l.data.versions,E=>(i(),b(w,{label:E},null,8,["label"]))),256))])):g("",!0)]),_:2},1024),t(n,{field:"description",header:"Description"}),t(n,{field:"analysis_status",header:"Analysis Status",sortable:""},{body:o(l=>[m("div",ve,[t(V,{value:l.data.analysis_status,severity:S(l.data.analysis_status),class:"text-xl w-auto"},null,8,["value","severity"])])]),_:2},1024),t(n,null,{body:o(l=>[t(u,{onClick:E=>R(l.data.acronym,l.data.versions),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["value"])]),default:o(()=>[t(n,{selectionMode:"multiple",headerStyle:"width: 3rem"}),t(n,{expander:"",style:{width:"3rem"}}),t(n,{field:"metadata",header:"Metadata",hidden:""}),t(n,{field:"acronym",header:"Title",sortable:""}),t(n,{field:"versions",header:"Versions",sortable:""},{body:o(s=>[s.data.versions.length>=1||s.data.versions[0]!=""?(i(),p("div",me,[(i(!0),p(k,null,I(s.data.versions,l=>(i(),b(w,{label:l},null,8,["label"]))),256))])):g("",!0)]),_:1}),t(n,{field:"doi",header:"DOI",sortable:""},{body:o(s=>[m("a",{class:"font-medium text-blue-600 dark:text-blue-500 hover:underline",href:O(s.data.doi),target:"_blank"},ae(s.data.doi),9,fe)]),_:1}),t(n,{field:"tags",header:"Tags",sortable:""},{body:o(s=>[s.data.tags.length>1||s.data.tags[0]!=""?(i(),p("div",_e,[(i(!0),p(k,null,I(s.data.tags,l=>(i(),b(w,{label:l},null,8,["label"]))),256))])):g("",!0)]),_:1}),t(n,{field:"analysis_status",header:"Analysis Status",sortable:""},{body:o(s=>[m("div",he,[t(V,{value:s.data.analysis_status,severity:S(s.data.analysis_status),class:"text-xl w-auto"},null,8,["value","severity"])])]),_:1}),t(n,null,{body:o(s=>[t(u,{onClick:l=>R(s.data.acronym,s.data.versions),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection","expanded-rows"]),t(L)])}}};export{De as default};
