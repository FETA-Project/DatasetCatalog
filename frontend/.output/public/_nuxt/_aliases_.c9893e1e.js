import{f as J,e as V,s as oe,i as T,o as n,j as s,v as x,c as I,w as A,k as h,t as a,m as e,q as m,p,x as g,d as z,_ as K,y as ae,z as ie,r as C,A as re,h as ce,u as t,B as W,C as N}from"./entry.281a66c0.js";import{a as D}from"./axios.4a70c6fc.js";import{M as de}from"./menu.bb4b1894.js";import{_ as G}from"./date.b378eba0.js";const ue={key:0},_e={key:1},me=e("hr",null,null,-1),ye={class:"flex justify-content-between flex-wrap"},pe={key:0},he={key:0},fe=["onClick"],ge=["onClick"],be=["onClick"],H={__name:"comments",props:{comments:{type:[Object,Array],required:!0}},emits:["signal"],setup($,{emit:E}){const j=J(),O=V();oe("dialogRef");const l=z(()=>K(()=>import("./create_comment.1677ebae.js"),["./create_comment.1677ebae.js","./entry.281a66c0.js","./entry.076fc270.css","./axios.4a70c6fc.js","./create_comment.6453e953.css"],import.meta.url)),y=(d,f=!1)=>{console.log(d),j.open(l,{props:{header:f?"Edit Comment":"Add Comment",modal:!0},data:{belongs_to:d.belongs_to,comment_id:d.id,edit:f,text:f?d.text:""},onClose:()=>{k(d.belongs_to)}})},b=d=>{D.delete("/api/comments/"+d.id).then(()=>{O.add({severity:"success",summary:"Success",detail:"Comment deleted",life:3e3}),k(d.belongs_to)}).catch(f=>{O.add({severity:"error",summary:"Error",detail:f,life:3e3})})},k=d=>{E("signal",d)};return(d,f)=>{const v=H,R=T("AccordionTab"),u=T("Accordion");return n(!0),s(g,null,x($.comments,c=>(n(),I(u,{activeIndex:0,style:{"margin-top":"0.5rem","margin-bottom":"0.5rem"}},{default:A(()=>[h(R,{header:c.deleted?"<deleted>":c.author},{default:A(()=>[c.deleted?(n(),s("span",ue,"<deleted>")):(n(),s("span",_e,a(c.text),1)),me,e("small",ye,[e("div",null,[h(G,{datetime:c.date},null,8,["datetime"]),m(),c.edited?(n(),s("span",pe," | edited ")):p("",!0)]),c.deleted?p("",!0):(n(),s("div",he,[e("span",{class:"link",onClick:U=>y(c)},"Reply",8,fe),m(" | "),e("span",{class:"link",onClick:U=>y(c,!0)},"Edit",8,ge),m(" | "),e("span",{class:"link",onClick:U=>b(c)},"Delete",8,be)]))]),h(v,{onSignal:k,comments:c.children},null,8,["comments"])]),_:2},1032,["header"])]),_:2},1024))),256)}}};const ke={style:{"list-style":"none"},class:"flex flex-column gap-1"},ve={key:0},Ce={key:0},$e={key:0,class:"pi pi-info-circle"},xe=["href"],Re={key:2,class:"styled-table"},we={key:3,style:{"white-space":"pre"}},De=["onClick"],Ae={key:1},Ue={key:0},Q={__name:"analysis",props:{acronym:{type:String,required:!0},aliases:{type:Array,required:!0},analysis:{type:Object,required:!0},files:{type:Array,required:!0}},setup($){const E=V(),j=(y,b,k)=>(console.log(b),"/jupyter/notebooks/"+y+(b.length==0?"":".")+b.join(".")+"/"+k),O=(y,b,k)=>{D.get(`/api/analysis_files/${encodeURIComponent(y)}/${encodeURIComponent(b)}/${encodeURIComponent(k)}`).then(d=>{const f=new Blob([d.data],{type:d.headers["content-type"]}),v=window.URL.createObjectURL(f),R=document.createElement("a");R.href=v;let u="filename";const c=d.headers["content-disposition"].match(/filename="(.+)"/);c&&c[1]&&(u=c[1]),R.setAttribute("download",u),document.body.appendChild(R),R.click()}).catch(d=>{E.add({severity:"error",summary:"Error while downloading dataset",detail:d.response.data,life:3e3})})},l=y=>{if(typeof y!="string"||!y.includes("{")||!y.includes("}"))return!1;try{return JSON.parse(y),!0}catch{return!1}};return(y,b)=>{const k=Q,d=T("Fieldset"),f=ae("tooltip");return n(!0),s(g,null,x($.analysis,(v,R)=>(n(),s(g,null,[typeof v=="object"?(n(),I(d,{key:0,legend:R.replaceAll("_"," "),toggleable:!0,style:{"margin-bottom":"1em"}},{default:A(()=>[e("ul",ke,[(n(!0),s(g,null,x(v,(u,c)=>(n(),s(g,null,[c.endsWith("_info")?p("",!0):(n(),s("li",ve,[typeof u!="object"?(n(),s("b",Ce,[v[c+"_info"]?ie((n(),s("i",$e,null,512)),[[f,v[c+"_info"],void 0,{left:!0}]]):p("",!0),m(" "+a(c.replaceAll("_"," "))+": ",1)])):p("",!0),typeof u=="string"&&u.endsWith(".ipynb")?(n(),s("a",{key:1,href:j($.acronym,$.aliases,u),target:"_blank"},a(u),9,xe)):l(u)?(n(),s("table",Re,[e("tbody",null,[(n(!0),s(g,null,x(JSON.parse(u),(U,L)=>(n(),s("tr",null,[e("td",null,a(L),1),e("td",null,a(U),1)]))),256))])])):typeof u!="object"?(n(),s("span",we,[$.files.includes(u)?(n(),s("span",{key:0,class:"file-link",onClick:U=>O($.acronym,$.aliases,u)},a(u),9,De)):(n(),s("span",Ae,a(u),1))])):p("",!0)]))],64))),256)),typeof v=="object"?(n(),s("span",Ue,[h(k,{analysis:v,acronym:$.acronym,aliases:$.aliases,files:$.files},null,8,["analysis","acronym","aliases","files"])])):p("",!0)])]),_:2},1032,["legend"])):p("",!0)],64))),256)}}};const Ie={class:"flex flex-column gap-3"},Ee={key:0},je=e("br",null,null,-1),Oe={class:"flex gap-2"},Te={class:"flex flex-column gap-2"},Se={key:0},Be=e("b",null,"Dataset's Parents",-1),Le=["onClick"],qe={key:1},Fe=e("b",null,"Dataset's Children",-1),Ne=["onClick"],Ve={key:2},Pe=e("b",null,"Origin Datasets",-1),Me=["onClick"],We={key:3},Je=e("b",null,"Related Datasets",-1),ze=["onClick"],Ke={key:4},Ge=e("b",null,"Datasets With the Same Origin",-1),He=["onClick"],Qe={style:{"list-style":"none"},class:"flex flex-column gap-2"},Xe={class:"flex gap-2"},Ye=e("b",null,"Acronym Aliases: ",-1),Ze=e("b",null,"Dataset Title: ",-1),et=e("b",null,"Paper Title: ",-1),tt={class:"flex gap-2"},nt=e("b",null,"Authors: ",-1),lt=e("b",null,"Date Submitted: ",-1),st=e("b",null,"Submitter: ",-1),ot=e("b",null,"Name: ",-1),at=e("b",null,"Email: ",-1),it=e("b",null,"Description: ",-1),rt=e("b",null,"Format: ",-1),ct=e("b",null,"DOI: ",-1),dt=["href"],ut=e("b",null,"Origins DOI: ",-1),_t=["href"],mt={class:"flex gap-2"},yt=e("b",null,"Tags: ",-1),pt=e("b",null,"Data URL: ",-1),ht=["href"],ft=e("b",null,"Data File: ",-1),Ct={__name:"[aliases]",setup($){const E=V(),j=C("Unknown"),O=C("Unknown"),l=C(),y=C(),b=C(),k=C(),d=C(),f=C(),v=C(),R=C(),u=re(),c=C({}),U=C(0),L=C(null),X=J(),Y=z(()=>K(()=>import("./create_comment.1677ebae.js"),["./create_comment.1677ebae.js","./entry.281a66c0.js","./entry.076fc270.css","./axios.4a70c6fc.js","./create_comment.6453e953.css"],import.meta.url)),S=(i,r)=>{r==""&&(r="*"),W(`/detail/${encodeURIComponent(i)}/${encodeURIComponent(r)}`)},Z=i=>{P()},P=()=>{D.get(`/api/comments/${encodeURIComponent(j.value)}`).then(i=>{c.value=i.data,U.value++}).catch(i=>{E.add({severity:"error",summary:"Error while getting comments",detail:i.response.data,life:3e3})})},ee=i=>{X.open(Y,{props:{header:"Add Comment",modal:!0},data:{belongs_to:i,parent_id:null,edit:!1,text:"",comment_id:null},onClose:()=>{P()}})},te=(i,r)=>{console.log("get"),console.log(i),console.log(r),D.all([D.get(`/api/datasets/${encodeURIComponent(i)}/${encodeURIComponent(r)}`),D.get(`/api/comments/${encodeURIComponent(i)}`)]).then(D.spread((_,q)=>{l.value=_.data.dataset,l.value.authors=l.value.authors.filter(w=>w!==""),l.value.acronym_aliases=l.value.acronym_aliases.filter(w=>w!==""),l.value.tags=l.value.tags.filter(w=>w!==""),v.value=_.data.dataset.analysis,R.value=_.data.edit_analysis_url,k.value=_.data.related_datasets,d.value=_.data.origin_datasets,f.value=_.data.same_origin_datasets,b.value=_.data.alias_children,y.value=_.data.alias_parents,c.value=q.data})).catch(_=>{E.add({severity:"error",summary:"Error while getting dataset",detail:_.response.data,life:3e3})})},ne=(i,r)=>{r==""&&(r="*"),W(`/edit/${encodeURIComponent(i)}/${encodeURIComponent(r)}`)},le=()=>{window.open(R.value,"_blank")},M=(i,r=!1)=>{let _=i;if(i)return/^https?:\/\//i.test(i)||(_=`https://${i}`),r?window.open(_,"_blank"):_;console.log("No URL - trying local file")},se=(i,r)=>{D.get(`/api/files/${encodeURIComponent(i)}/${encodeURIComponent(r)}`).then(_=>{window.open(_.data.filelink,"_blank")}).catch(_=>{E.add({severity:"error",summary:"Error while downloading dataset",detail:_.response.data,life:3e3})})};return ce(()=>{j.value=decodeURIComponent(u.params.acronym),O.value=decodeURIComponent(u.params.aliases),te(j.value,O.value),D.get("/api/users/me").then(i=>{console.log(i.data),L.value=i.data}).catch()}),(i,r)=>{const _=T("Toast"),q=T("Badge"),w=T("Button"),F=T("Fieldset");return n(),s("div",Ie,[h(_,{position:"bottom-right"}),h(de),e("h1",null,[m(" Details of "+a(t(l).acronym+(t(l).acronym_aliases.length==0?"":".")+t(l).acronym_aliases.join("."))+" ",1),t(l).status=="requested"?(n(),s("div",Ee,[h(q,{value:"Requested",severity:"info"}),je])):p("",!0)]),e("h2",Oe,[t(l).filename?(n(),I(w,{key:0,onClick:r[0]||(r[0]=o=>se(t(l).acronym,t(l).acronym_aliases)),label:"Download",icon:"pi pi-download",severity:"success"})):p("",!0),t(l).url?(n(),I(w,{key:1,onClick:r[1]||(r[1]=o=>M(t(l).url,!0)),label:"Open URL",icon:"pi pi-link",severity:"success"})):p("",!0),h(w,{onClick:r[2]||(r[2]=o=>ne(t(l).acronym,t(l).acronym_aliases)),label:"Edit Info",icon:"pi pi-pencil"}),h(w,{onClick:r[3]||(r[3]=o=>le(t(l).acronym)),label:"Edit Analysis",icon:"pi pi-external-link",severity:"secondary"})]),h(F,{legend:"Related Datasets",toggleable:!0,collapsed:""},{default:A(()=>[e("ul",Te,[t(y).length>0?(n(),s("div",Se,[Be,(n(!0),s(g,null,x(t(y),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>S(o.acronym,o.aliases)},a(o.acronym+"["+o.aliases+"]"),9,Le)]))),256))])):p("",!0),t(b).length>0?(n(),s("div",qe,[Fe,(n(!0),s(g,null,x(t(b),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>S(o.acronym,o.aliases)},a(o.acronym+"["+o.aliases+"]"),9,Ne)]))),256))])):p("",!0),t(d).length>0?(n(),s("div",Ve,[Pe,(n(!0),s(g,null,x(t(d),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>S(o.acronym,o.aliases)},a(o.acronym+"["+o.aliases+"]"),9,Me)]))),256))])):p("",!0),t(k).length>0?(n(),s("div",We,[Je,(n(!0),s(g,null,x(t(k),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>S(o.acronym,o.aliases)},a(o.acronym+"["+o.aliases+"]"),9,ze)]))),256))])):p("",!0),t(f).length>0?(n(),s("div",Ke,[Ge,(n(!0),s(g,null,x(t(f),o=>(n(),s("li",null,[e("span",{class:"detail-link",onClick:B=>S(o.acronym,o.aliases)},a(o.acronym+"["+o.aliases+"]"),9,He)]))),256))])):p("",!0)])]),_:1}),h(F,{legend:"Details",toggleable:!0},{default:A(()=>[e("ul",Qe,[e("li",Xe,[Ye,(n(!0),s(g,null,x(t(l).acronym_aliases,o=>(n(),I(t(N),null,{default:A(()=>[m(a(o),1)]),_:2},1024))),256))]),e("li",null,[Ze,m(" "+a(t(l).title),1)]),e("li",null,[et,m(" "+a(t(l).paper_title),1)]),e("li",tt,[nt,(n(!0),s(g,null,x(t(l).authors,o=>(n(),I(t(N),null,{default:A(()=>[m(a(o),1)]),_:2},1024))),256))]),e("li",null,[lt,m(),h(G,{datetime:t(l).date_submitted},null,8,["datetime"])]),e("li",null,[st,e("ul",null,[e("li",null,[ot,m(" "+a(t(l).submitter.name),1)]),e("li",null,[at,m(" "+a(t(l).submitter.email),1)])])]),e("li",null,[it,m(" "+a(t(l).description),1)]),e("li",null,[rt,m(" "+a(t(l).format),1)]),e("li",null,[ct,m(),e("a",{href:t(l).doi,target:"_blank"},a(t(l).doi),9,dt)]),e("li",null,[ut,m(),e("a",{href:t(l).origins_doi,target:"_blank"},a(t(l).origins_doi),9,_t)]),e("li",mt,[yt,(n(!0),s(g,null,x(t(l).tags,o=>(n(),I(t(N),null,{default:A(()=>[m(a(o),1)]),_:2},1024))),256))]),e("li",null,[pt,m(),e("a",{href:M(t(l).url),about:"_blank"},a(t(l).url),9,ht)]),e("li",null,[ft,m(" "+a(t(l).filename),1)])])]),_:1}),h(F,{legend:"Discussion",toggleable:!0,collapsed:""},{default:A(()=>[h(w,{label:"Add Comment",icon:"pi pi-plus",severity:"secondary",onClick:r[4]||(r[4]=o=>ee(t(l).acronym)),style:{"margin-bottom":"0.3em"}}),(n(),I(H,{onSignal:Z,comments:t(c),key:t(U)},null,8,["comments"]))]),_:1}),h(Q,{analysis:t(v).analysis,acronym:t(l).acronym,aliases:t(l).acronym_aliases,files:t(l).files},null,8,["analysis","acronym","aliases","files"])])}}};export{Ct as default};
