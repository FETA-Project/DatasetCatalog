import{a as L,b as J,e as z,f as G,r as b,h as M,i as c,j as p,k as l,w as u,u as i,l as R,m as e,o as s,c as C,p as E,x,v as w,q as h,t as m,F as H,B as K,d as Q,_ as W}from"./entry.281a66c0.js";import{a as A}from"./axios.4a70c6fc.js";import{M as X}from"./menu.bb4b1894.js";import{_ as Y}from"./date.b378eba0.js";const Z=e("h1",null,"Dataset Catalog",-1),P={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},ee={class:"p-input-icon-left"},te=e("i",{class:"pi pi-search"},null,-1),ae={class:"flex gap-1"},le=["href"],ne={class:"flex gap-1"},oe={class:"flex"},se={key:0,style:{"list-style":"none"}},ie=e("b",null,"Children:",-1),de=["onClick"],re={class:"flex"},ce={style:{"list-style":"none"}},ue=e("b",null,"Paper Title: ",-1),me={class:"flex gap-2"},_e=e("b",null,"Authors: ",-1),pe=e("b",null,"Date Submitted: ",-1),he=e("b",null,"Submitter: ",-1),fe=e("b",null,"Name: ",-1),ye=e("b",null,"Email: ",-1),be=e("b",null,"Description: ",-1),ge=e("b",null,"Origins: ",-1),ve=["href"],$e={__name:"index",setup(De){L();const N=J(),g=z(),V=G(),k=b(null),_=b([]),T=b([]),$=b({global:{value:null,matchMode:H.CONTAINS}}),v=b([]),B=Q(()=>W(()=>import("./upload.cbc2af7c.js"),["./upload.cbc2af7c.js","./entry.281a66c0.js","./entry.076fc270.css","./axios.4a70c6fc.js","./upload.6918fed0.css"],import.meta.url)),S=()=>{A.get("/api/datasets").then(n=>{console.log(n.data),v.value=n.data.filter(t=>t.parents.length==0),console.log(v.value),v.value.forEach(t=>{t.metadata=JSON.stringify(t,function(D,r){if(r&&typeof r=="object"){var f={};for(var y in r)Object.hasOwnProperty.call(r,y)&&(f[y&&y.replaceAll("_"," ")]=r[y]);return f}return r})})}).catch(n=>{g.add({severity:"error",summary:"Error while getting datasets",detail:n.response.data,life:3e3})})};M(()=>{S()});const I=(n,t)=>{console.log(n,t),t==""&&(t="*"),K(`/detail/${encodeURIComponent(n)}/${encodeURIComponent(t)}`)},O=()=>{let n=[];_.value.forEach(t=>{n.push({acronym:t.acronym,aliases:t.acronym_aliases})}),N.require({message:`Are you sure you want to delete ${n.length} files`,header:"Delete Confirmation",icon:"pi pi-exclemation-triangle",accept:()=>{_.value=null,n.forEach(t=>{A.delete(`/api/datasets/${encodeURIComponent(t.acronym)}/${encodeURIComponent(t.aliases)}`).then(()=>{g.add({severity:"success",summary:"Delete Successful",detail:`Dataset ${t.acronym}/${t.aliases} deleted successfully.`,life:3e3}),S()}).catch(D=>{g.add({severity:"error",summary:"Delete Failed",detail:D.response.data,life:3e3})})})}})},F=()=>{V.open(B,{props:{header:"Submit Dataset",modal:!0},onClose:n=>{const t=n.data;t&&(g.add({severity:"success",summary:"Upload Successful",detail:`File ${t} uploaded successfully.`,life:3e3}),S())}})};return M(()=>{A.get("/api/users/me").then(n=>{k.value=n.data}).catch()}),(n,t)=>{const D=c("Toast"),r=c("ConfirmDialog"),f=c("Button"),y=c("InputText"),d=c("Column"),U=c("Chip"),j=c("DataTable"),q=c("DynamicDialog");return s(),p("div",null,[l(D,{position:"bottom-right"}),l(X),Z,l(r),l(j,{value:i(v),scrollable:"",filters:i($),selection:i(_),"onUpdate:selection":t[2]||(t[2]=a=>R(_)?_.value=a:null),"expanded-rows":i(T),"onUpdate:expandedRows":t[3]||(t[3]=a=>R(T)?T.value=a:null)},{header:u(()=>[e("div",P,[e("div",null,[l(f,{label:"Submit Dataset",icon:"pi pi-ticket",class:"mr-2",onClick:F}),i(k)&&i(k).is_admin?(s(),C(f,{key:0,label:"Delete",icon:"pi pi-trash",class:"mr-2",severity:"danger",onClick:t[0]||(t[0]=a=>O()),disabled:!i(_)||!i(_).length},null,8,["disabled"])):E("",!0)]),e("span",ee,[te,l(y,{modelValue:i($).global.value,"onUpdate:modelValue":t[1]||(t[1]=a=>i($).global.value=a),placeholder:"Search..."},null,8,["modelValue"])])])]),expansion:u(a=>[e("div",oe,[a.data.children.length>0?(s(),p("ul",se,[e("li",null,[ie,e("ul",null,[(s(!0),p(x,null,w(a.data.children,o=>(s(),p("li",null,[e("span",{class:"detail-link",onClick:Ce=>I(o.acronym,o.acronym_aliases)},m(o.acronym+"["+o.acronym_aliases+"]"),9,de)]))),256))])])])):E("",!0)]),e("div",re,[e("ul",ce,[e("li",null,[ue,h(" "+m(a.data.paper_title),1)]),e("li",me,[_e,(s(!0),p(x,null,w(a.data.authors,o=>(s(),C(U,null,{default:u(()=>[h(m(o),1)]),_:2},1024))),256))]),e("li",null,[pe,h(),l(Y,{datetime:a.data.date_submitted},null,8,["datetime"])]),e("li",null,[he,e("ul",null,[e("li",null,[fe,h(" "+m(a.data.submitter.name),1)]),e("li",null,[ye,h(" "+m(a.data.submitter.email),1)])])]),e("li",null,[be,h(" "+m(a.data.description),1)]),e("li",null,[ge,h(),e("a",{href:a.data.origins_doi,target:"_blank"},m(a.data.origins_doi),9,ve)])])])]),default:u(()=>[l(d,{selectionMode:"multiple",headerStyle:"width: 3rem"}),l(d,{expander:"",style:{width:"3rem"}}),l(d,{field:"metadata",header:"Metadata",hidden:""}),l(d,{field:"acronym",header:"Acronym",sortable:""}),l(d,{field:"acronym_aliases",header:"Acronym Aliases","sortable.multiple":""},{body:u(a=>[e("div",ae,[(s(!0),p(x,null,w(a.data.acronym_aliases,o=>(s(),C(U,{label:o},null,8,["label"]))),256))])]),_:1}),l(d,{field:"title",header:"Title",sortable:""}),l(d,{field:"doi",header:"DOI"},{body:u(a=>[e("a",{href:"https://doi.org/"+a.data.doi,target:"_blank"},m(a.data.doi),9,le)]),_:1}),l(d,{field:"tags",header:"Tags"},{body:u(a=>[e("div",ne,[(s(!0),p(x,null,w(a.data.tags,o=>(s(),C(U,{label:o},null,8,["label"]))),256))])]),_:1}),l(d,null,{body:u(a=>[l(f,{onClick:o=>I(a.data.acronym,a.data.acronym_aliases),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection","expanded-rows"]),l(q)])}}};export{$e as default};
