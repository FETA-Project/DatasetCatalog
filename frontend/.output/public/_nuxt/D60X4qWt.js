const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./pnJzu439.js","./DU3s_J-k.js","./DW_MHI2K.js","./upload.CMNI5XCl.css"])))=>i.map(i=>d[i]);
import{u as z,m as G,n as H,p as K,r as _,q as Q,c as p,b as a,a as m,w as o,s as T,v as r,x as X,o as i,y as Y,z as Z,A as P,C as g,N as k,L as I,B as b,W as ee,t as te,U as ae,D as se,E as le,F as ne,G as oe,H as ie,V as re,I as de,J as ce}from"./DU3s_J-k.js";import{a as U}from"./DW_MHI2K.js";import{M as ue}from"./CeymNAjJ.js";const pe={class:"flex flex-wrap gap-2 items-center justify-between"},me={key:0,class:"flex gap-1"},fe=["href"],_e={key:0,class:"flex gap-1"},he={class:"flex gap-1"},ye={key:0,class:"flex gap-1"},ve={class:"flex gap-1"},De={__name:"index",setup(ge){z();const B=G(),h=H(),M=K(),x=_(null),c=_([]),C=_([]),D=_({global:{value:null,matchMode:"contains"}}),y=_([]),F=de(()=>ce(()=>import("./pnJzu439.js"),__vite__mapDeps([0,1,2,3]),import.meta.url)),S=t=>t=="Requested"?"info":t=="In Progress"?"warn":t=="Completed"?"success":"danger",O=t=>t.startsWith("http://")||t.startsWith("https://")||t.startsWith("doi.org")?t:"https://doi.org/"+t,$=()=>{U.get("/api/datasets").then(t=>{console.log(t.data),y.value=t.data.filter(e=>e.is_child==!1),console.log(y.value),y.value.forEach(e=>{console.log("dataset: ",e," (children: )",e.version_children.length),e.metadata=JSON.stringify(e,function(v,d){if(d&&typeof d=="object"){var u={};for(var f in d)Object.hasOwnProperty.call(d,f)&&(u[f&&f.replaceAll("_"," ")]=d[f]);return u}return d})})}).catch(t=>{h.add({severity:"error",summary:"Error while getting datasets",detail:t.response.data,life:3e3})})},R=(t,e)=>{console.log(t,e),e==""&&(e="*"),re(`/detail/${encodeURIComponent(t)}/${encodeURIComponent(e)}`)},N=()=>{let t=[];c.value.forEach(e=>{t.push({acronym:e.acronym,versions:e.versions})}),B.require({message:`Are you sure you want to delete ${t.length} files`,header:"Delete Confirmation",icon:"pi pi-exclemation-triangle",accept:()=>{c.value=null,t.forEach(e=>{U.delete(`/api/datasets/${encodeURIComponent(e.acronym)}/${encodeURIComponent(e.versions)}`).then(()=>{h.add({severity:"success",summary:"Delete Successful",detail:`Dataset ${e.acronym}/${e.versions} deleted successfully.`,life:3e3}),$()}).catch(v=>{h.add({severity:"error",summary:"Delete Failed",detail:v.response.data,life:3e3})})})}})},W=()=>{M.open(F,{props:{header:"Submit Dataset",modal:!0},onClose:t=>{const e=t.data;e&&(h.add({severity:"success",summary:"Upload Successful",detail:`File ${e} uploaded successfully.`,life:3e3}),$())}})};Q(()=>{$(),U.get("/api/users/me").then(t=>{x.value=t.data}).catch()});const j=t=>t.version_children.length>0?"":"no-expander";return(t,e)=>{const v=Y,d=Z,u=se,f=ne,q=oe,L=le,n=P,w=ee,V=ae,A=X,J=ie;return i(),p("div",null,[a(v,{position:"bottom-right"}),a(ue),e[5]||(e[5]=m("h1",{class:"m-4 text-3xl font-bold"},"Dataset Catalog",-1)),a(d),a(A,{value:r(y),scrollable:"",filters:r(D),selection:r(c),"onUpdate:selection":e[2]||(e[2]=s=>T(c)?c.value=s:null),"expanded-rows":r(C),"onUpdate:expandedRows":e[3]||(e[3]=s=>T(C)?C.value=s:null),rowClass:j},{header:o(()=>[m("div",pe,[m("div",null,[a(u,{label:"Submit Dataset",icon:"pi pi-ticket",class:"mr-2",onClick:W}),r(x)&&r(x).is_admin?(i(),b(u,{key:0,label:"Delete",icon:"pi pi-trash",class:"mr-2",severity:"danger",onClick:e[0]||(e[0]=s=>N()),disabled:!r(c)||!r(c).length},null,8,["disabled"])):g("",!0)]),a(L,null,{default:o(()=>[a(f,null,{default:o(()=>e[4]||(e[4]=[m("i",{class:"pi pi-search"},null,-1)])),_:1}),a(q,{modelValue:r(D).global.value,"onUpdate:modelValue":e[1]||(e[1]=s=>r(D).global.value=s),placeholder:"Search..."},null,8,["modelValue"])]),_:1})])]),expansion:o(s=>[a(A,{class:"w-full",value:s.data.version_children.filter(l=>l.versions.length>0),scrollable:""},{default:o(()=>[a(n,{field:"acronym",header:"Acronym",sortable:"",hidden:""}),a(n,{field:"versions",header:"Versions",sortable:""},{body:o(l=>[l.data.versions.length>=1||l.data.versions[0]!=""?(i(),p("div",ye,[(i(!0),p(k,null,I(l.data.versions,E=>(i(),b(w,{label:E},null,8,["label"]))),256))])):g("",!0)]),_:2},1024),a(n,{field:"description",header:"Description"}),a(n,{field:"analysis_status",header:"Analysis Status",sortable:""},{body:o(l=>[m("div",ve,[a(V,{value:l.data.analysis_status,severity:S(l.data.analysis_status),class:"text-xl w-auto"},null,8,["value","severity"])])]),_:2},1024),a(n,null,{body:o(l=>[a(u,{onClick:E=>R(l.data.acronym,l.data.versions),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:2},1024)]),_:2},1032,["value"])]),default:o(()=>[a(n,{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(n,{expander:"",style:{width:"3rem"}}),a(n,{field:"metadata",header:"Metadata",hidden:""}),a(n,{field:"acronym",header:"Title",sortable:""}),a(n,{field:"versions",header:"Versions",sortable:""},{body:o(s=>[s.data.versions.length>=1||s.data.versions[0]!=""?(i(),p("div",me,[(i(!0),p(k,null,I(s.data.versions,l=>(i(),b(w,{label:l},null,8,["label"]))),256))])):g("",!0)]),_:1}),a(n,{field:"doi",header:"DOI",sortable:""},{body:o(s=>[m("a",{class:"font-medium text-blue-600 dark:text-blue-500 hover:underline",href:O(s.data.doi),target:"_blank"},te(s.data.doi),9,fe)]),_:1}),a(n,{field:"tags",header:"Tags",sortable:""},{body:o(s=>[s.data.tags.length>1||s.data.tags[0]!=""?(i(),p("div",_e,[(i(!0),p(k,null,I(s.data.tags,l=>(i(),b(w,{label:l},null,8,["label"]))),256))])):g("",!0)]),_:1}),a(n,{field:"analysis_status",header:"Analysis Status",sortable:""},{body:o(s=>[m("div",he,[a(V,{value:s.data.analysis_status,severity:S(s.data.analysis_status),class:"text-xl w-auto"},null,8,["value","severity"])])]),_:1}),a(n,null,{body:o(s=>[a(u,{onClick:l=>R(s.data.acronym,s.data.versions),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection","expanded-rows"]),a(J)])}}};export{De as default};
