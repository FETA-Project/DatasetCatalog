import{E as x,a as S,G as $,H as k,r as f,e as A,f as n,h as M,i as a,w as h,u as o,I,j as u,o as U,J as V,p as B,d as N,_ as F}from"./entry.0ea88f22.js";import{a as _,M as H}from"./menu.5bf7707e.js";const O=u("h1",null," Requested For Analysis ",-1),P={class:"flex flex-wrap gap-2 align-items-center justify-content-between"},G={class:"p-input-icon-left"},J=u("i",{class:"pi pi-search"},null,-1),W={__name:"requests",setup(L){x();const i=S(),g=$(),y=k(),s=f([]),b=N(()=>F(()=>import("./upload.ec9e8519.js"),["./upload.ec9e8519.js","./entry.0ea88f22.js","./entry.076fc270.css","./menu.5bf7707e.js","./menu.16430c06.css","./upload.8026df64.css"],import.meta.url)),m=f({global:{value:null,matchMode:V.CONTAINS}}),v=f([]),d=()=>{_.get("/api/requests").then(t=>{v.value=t.data}).catch(t=>{i.add({severity:"error",summary:"Error while getting requests",detail:t.response.data,life:3e3})})};A(()=>d());const D=()=>{let t=[];s.value.forEach(e=>{t.push(e.title)}),console.log(t),g.require({message:`Are you sure you want to reject ${t.length} datasets?`,header:"Reject Confirmation",icon:"pi pi-exclemation-triangle",accept:()=>{s.value=null,t.forEach(e=>{_.delete(`/api/requests/${e}`).then(()=>{i.add({severity:"success",summary:"Rejection Successful",detail:`Dataset ${e} rejected.`,life:3e3}),d()}).catch(c=>{i.add({severity:"error",summary:"Error while rejecting request",detail:c.response.data,life:3e3})})})}})},C=()=>{let t=[];s.value.forEach(e=>{t.push(e.title)}),console.log(t),t.forEach(e=>{_.head(`/api/requests/${e}`).then(()=>{i.add({severity:"success",summary:"Approval Successful",detail:`Request ${e} approved.`}),d()}).catch(c=>{i.add({severity:"error",summary:"Error while accepting request",detail:c.response.data,life:3e3})})})},q=t=>{B(`/detail/${encodeURIComponent(t)}`)},E=()=>{y.open(b,{props:{header:"Submit Dataset",modal:!0},onClose:t=>{const e=t.data;e&&(i.add({severity:"success",summary:"Upload Successful",detail:`File ${e} uploaded successfully.`,life:3e3}),d())}})};return(t,e)=>{const c=n("ConfirmDialog"),w=n("Toast"),p=n("Button"),R=n("InputText"),r=n("Column"),T=n("DataTable"),j=n("DynamicDialog");return U(),M("div",null,[a(H),O,a(c),a(T,{value:o(v),scrollable:"",scrollHeight:"500px",filters:o(m),selection:o(s),"onUpdate:selection":e[3]||(e[3]=l=>I(s)?s.value=l:null)},{header:h(()=>[u("div",P,[u("div",null,[a(p,{label:"Submit Dataset",icon:"pi pi-ticket",class:"mr-2",onClick:E}),a(p,{label:"Approve",icon:"pi pi-check",severity:"success",class:"mr-2",onClick:e[0]||(e[0]=l=>C()),disabled:!o(s)||!o(s).length},null,8,["disabled"]),a(p,{label:"Reject",icon:"pi pi-ban",severity:"danger",onClick:e[1]||(e[1]=l=>D()),disabled:!o(s)||!o(s).length},null,8,["disabled"])]),u("span",G,[J,a(R,{modelValue:o(m).global.value,"onUpdate:modelValue":e[2]||(e[2]=l=>o(m).global.value=l),placeholder:"Search..."},null,8,["modelValue"])])])]),default:h(()=>[a(w,{position:"bottom-right"}),a(r,{selectionMode:"multiple",headerStyle:"width: 3rem"}),a(r,{field:"acronym",header:"Dataset Acronym",sortable:""}),a(r,{field:"title",header:"Dataset Title",sortable:""}),a(r,{field:"submitter.name",header:"Submitter Name"}),a(r,{field:"submitter.email",header:"Submitter Email"}),a(r,null,{body:h(l=>[a(p,{onClick:z=>q(l.data.acronym),label:"Details",icon:"pi pi-info-circle",rounded:"",outlined:""},null,8,["onClick"])]),_:1})]),_:1},8,["value","filters","selection"]),a(j)])}}};export{W as default};
